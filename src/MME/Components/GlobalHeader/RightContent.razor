@namespace MME.Components
@inherits AntDomComponentBase
@using Microsoft.AspNetCore.Components.Authorization
@using MME.Services.Auth
@inject AuthenticationStateProvider AuthenticationStateProvider

<Space Class="@ClassMapper.Class" Size="@("26")">
    <AuthorizeView>
        <Authorized>
            <Dropdown>
                <Overlay>
                    <Menu>
                        <MenuItem OnClick="HandleLogout">
                            <Icon Type="logout" Style="margin-right: 8px;" />
                            退出登录
                        </MenuItem>
                    </Menu>
                </Overlay>
                <ChildContent>
                    <Space Class="action user-dropdown" Size="@SpaceSize.Small">
                        <Avatar Size="@AvatarSize.Small" Icon="user" />
                        <span class="username-text">@GetUserName(context as Microsoft.AspNetCore.Components.Authorization.AuthenticationState)</span>
                        <Icon Type="down" />
                    </Space>
                </ChildContent>
            </Dropdown>
        </Authorized>
        <NotAuthorized>
            <Button Type="@ButtonType.Primary" OnClick="@(() => NavigationManager.NavigateTo("/user/login"))">
                登录
            </Button>
        </NotAuthorized>
    </AuthorizeView>
</Space>

